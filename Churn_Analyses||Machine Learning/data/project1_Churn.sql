<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #131313; -webkit-text-stroke: #131313}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #131313; -webkit-text-stroke: #131313; min-height: 14.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #523c16; -webkit-text-stroke: #523c16}
    span.s1 {font-kerning: none; color: #0000ff; background-color: #fffffe; -webkit-text-stroke: 0px #0000ff}
    span.s2 {font-kerning: none; background-color: #fffffe}
    span.s3 {font-kerning: none; color: #523c16; background-color: #fffffe; -webkit-text-stroke: 0px #523c16}
    span.s4 {font-kerning: none; background-color: #fffffe; -webkit-text-stroke: 0px #000000}
    span.s5 {font-kerning: none; color: #156738; background-color: #fffffe; -webkit-text-stroke: 0px #156738}
    span.s6 {font-kerning: none; color: #131313; background-color: #fffffe; -webkit-text-stroke: 0px #131313}
    span.s7 {font-kerning: none}
    span.s8 {font-kerning: none; color: #131313; background-color: #fffffe; -webkit-text-stroke: 0px #000000}
    span.s9 {font-kerning: none; color: #7c0010; background-color: #fffffe; -webkit-text-stroke: 0px #7c0010}
  </style>
</head>
<body>
<p class="p1"><span class="s1">SELECT</span><span class="s2"> Gender, </span><span class="s3">COUNT</span><span class="s2">(Gender) </span><span class="s1">as</span><span class="s2"> TotalCount,</span></p>
<p class="p1"><span class="s3">COUNT</span><span class="s2">(Gender) </span><span class="s4">*</span><span class="s5">100</span><span class="s2">.</span><span class="s5">0</span><span class="s2"> </span><span class="s4">/</span><span class="s2">(</span><span class="s1">SELECT</span><span class="s2"> </span><span class="s3">COUNT</span><span class="s2">(</span><span class="s4">*</span><span class="s2">) </span><span class="s1">FROM</span><span class="s2"> stg_Churn) </span><span class="s1">as</span><span class="s2"> </span><span class="s1">Percentage</span></p>
<p class="p1"><span class="s1">FROM</span><span class="s2"> stg_Churn</span></p>
<p class="p2"><span class="s2">GROUP BY</span><span class="s6"> Gender</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SELECT</span><span class="s6"> </span><span class="s2">Contract</span><span class="s6">, </span><span class="s3">COUNT</span><span class="s6">(</span><span class="s2">Contract</span><span class="s6">) </span><span class="s2">as</span><span class="s6"> TotalCount,</span></p>
<p class="p2"><span class="s3">Count</span><span class="s6">(</span><span class="s2">Contract</span><span class="s6">)</span><span class="s8">*</span><span class="s5">1</span><span class="s6">.</span><span class="s5">0</span><span class="s6"> </span><span class="s8">/</span><span class="s6"> (</span><span class="s2">SELECT</span><span class="s6"> </span><span class="s3">COUNT</span><span class="s6">(</span><span class="s8">*</span><span class="s6">) </span><span class="s2">from</span><span class="s6"> stg_Churn) </span><span class="s2">as</span><span class="s6"> </span><span class="s2">Percentage</span></p>
<p class="p1"><span class="s1">FROM</span><span class="s2"> stg_Churn</span></p>
<p class="p2"><span class="s2">GROUP BY</span><span class="s6"> </span><span class="s2">Contract</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s1">SELECT</span><span class="s2"> Customer_Status, </span><span class="s3">COUNT</span><span class="s2">(Customer_Status) </span><span class="s1">as</span><span class="s2"> TotalCount, </span><span class="s3">Sum</span><span class="s2">(Total_Revenue) </span><span class="s1">as</span><span class="s2"> Total_Rev,</span></p>
<p class="p1"><span class="s3">Sum</span><span class="s2">(Total_Revenue) </span><span class="s4">/</span><span class="s2"> (</span><span class="s1">SELECT</span><span class="s2"> </span><span class="s3">Sum</span><span class="s2">(Total_Revenue) </span><span class="s1">from</span><span class="s2"> stg_Churn) </span><span class="s4">*</span><span class="s2"> </span><span class="s5">100</span><span class="s2"> </span><span class="s1">as</span><span class="s2"> Rev_Percentage</span></p>
<p class="p1"><span class="s1">from</span><span class="s2"> stg_Churn</span></p>
<p class="p1"><span class="s1">GROUP BY</span><span class="s2"> Customer_Status</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s1">SELECT</span><span class="s2"> </span><span class="s1">state</span><span class="s2">, </span><span class="s3">COUNT</span><span class="s2">(</span><span class="s1">state</span><span class="s2">) </span><span class="s1">as</span><span class="s2"> TotalCount,</span></p>
<p class="p2"><span class="s3">COUNT</span><span class="s6">(</span><span class="s2">state</span><span class="s6">) </span><span class="s8">*</span><span class="s6"> </span><span class="s5">100</span><span class="s6">.</span><span class="s5">0</span><span class="s6"> </span><span class="s8">/</span><span class="s6"> (</span><span class="s2">SELECT</span><span class="s6"> </span><span class="s3">COUNT</span><span class="s6">(</span><span class="s2">state</span><span class="s6">) </span><span class="s2">from</span><span class="s6"> stg_Churn) </span><span class="s2">as</span><span class="s6"> </span><span class="s2">PERCENTAGE</span></p>
<p class="p1"><span class="s1">FROM</span><span class="s2"> stg_Churn</span></p>
<p class="p2"><span class="s2">GROUP BY</span><span class="s6"> </span><span class="s2">state</span></p>
<p class="p2"><span class="s2">Order BY</span><span class="s6"> </span><span class="s2">PERCENTAGE</span><span class="s6"> </span><span class="s2">desc</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SELECT DISTINCT</span><span class="s6"> Internet_Type</span></p>
<p class="p1"><span class="s1">from</span><span class="s2"> stg_Churn</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SELECT</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Customer_ID </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Customer_ID_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Gender </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Gender_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Age </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Age_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Married </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Married_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> </span><span class="s1">State</span><span class="s2"> </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> State_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Number_of_Referrals </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Number_of_Referrals_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Tenure_in_Months </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Tenure_in_Months_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Value_Deal </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Value_Deal_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Phone_Service </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Phone_Service_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Multiple_Lines </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Multiple_Lines_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Internet_Service </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Internet_Service_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Internet_Type </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Internet_Type_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Online_Security </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Online_Security_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Online_Backup </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Online_Backup_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Device_Protection_Plan </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Device_Protection_Plan_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Premium_Support </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Premium_Support_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Streaming_TV </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Streaming_TV_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Streaming_Movies </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Streaming_Movies_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Streaming_Music </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Streaming_Music_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Unlimited_Data </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Unlimited_Data_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> </span><span class="s1">Contract</span><span class="s2"> </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Contract_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Paperless_Billing </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Paperless_Billing_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Payment_Method </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Payment_Method_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Monthly_Charge </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Monthly_Charge_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Total_Charges </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Total_Charges_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Total_Refunds </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Total_Refunds_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Total_Extra_Data_Charges </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Total_Extra_Data_Charges_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Total_Long_Distance_Charges </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Total_Long_Distance_Charges_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Total_Revenue </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Total_Revenue_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Customer_Status </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Customer_Status_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Churn_Category </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Churn_Category_Null_Count,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">SUM</span><span class="s2">(</span><span class="s1">CASE</span><span class="s2"> </span><span class="s1">WHEN</span><span class="s2"> Churn_Reason </span><span class="s1">IS</span><span class="s2"> </span><span class="s1">NULL</span><span class="s2"> </span><span class="s1">THEN</span><span class="s2"> </span><span class="s5">1</span><span class="s2"> </span><span class="s1">ELSE</span><span class="s2"> </span><span class="s5">0</span><span class="s2"> </span><span class="s1">END</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Churn_Reason_Null_Count</span></p>
<p class="p1"><span class="s1">FROM</span><span class="s2"> stg_Churn;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SELECT</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Customer_ID,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Gender,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Age,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Married,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">State</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Number_of_Referrals,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Tenure_in_Months,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Value_Deal, </span><span class="s9">'None'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Value_Deal,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Phone_Service,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Multiple_Lines, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">As</span><span class="s2"> Multiple_Lines,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Internet_Service,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Internet_Type, </span><span class="s9">'None'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Internet_Type,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Online_Security, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Online_Security,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Online_Backup, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Online_Backup,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Device_Protection_Plan, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Device_Protection_Plan,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Premium_Support, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Premium_Support,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Streaming_TV, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Streaming_TV,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Streaming_Movies, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Streaming_Movies,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Streaming_Music, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Streaming_Music,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Unlimited_Data, </span><span class="s9">'No'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Unlimited_Data,</span></p>
<p class="p2"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">Contract</span><span class="s6">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Paperless_Billing,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Payment_Method,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Monthly_Charge,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Total_Charges,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Total_Refunds,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Total_Extra_Data_Charges,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Total_Long_Distance_Charges,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Total_Revenue,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>Customer_Status,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Churn_Category, </span><span class="s9">'Others'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Churn_Category,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">ISNULL</span><span class="s2">(Churn_Reason , </span><span class="s9">'Others'</span><span class="s2">) </span><span class="s1">AS</span><span class="s2"> Churn_Reason</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s1">INTO</span><span class="s2"> [db_Churn].[dbo].[prod_Churn]</span></p>
<p class="p1"><span class="s1">FROM</span><span class="s2"> [db_Churn].[dbo].[stg_Churn];</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s1">CREATE</span><span class="s6"> </span><span class="s1">View</span><span class="s6"> </span><span class="s2">vw_churnData</span><span class="s6"> </span><span class="s1">as</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">SELECT</span><span class="s2"> </span><span class="s4">*</span><span class="s2"> </span><span class="s1">FROM</span><span class="s2"> dbo.prod_Churn </span><span class="s1">where</span><span class="s2"> Customer_Status </span><span class="s1">IN</span><span class="s2"> (</span><span class="s9">'Churned'</span><span class="s2">, </span><span class="s9">'Stayed'</span><span class="s2">)</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">CREATE</span><span class="s6"> </span><span class="s2">View</span><span class="s6"> </span><span class="s3">vw_JoinData</span><span class="s6"> </span><span class="s2">as</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">SELECT</span><span class="s2"> </span><span class="s4">*</span><span class="s2"> </span><span class="s1">FROM</span><span class="s2"> prod_Churn </span><span class="s1">where</span><span class="s2"> Customer_Status </span><span class="s4">=</span><span class="s2"> </span><span class="s9">'Joined'</span><span class="s2"> <span class="Apple-converted-space">   </span></span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s1">SELECT</span><span class="s2"> </span><span class="s4">*</span><span class="s2"> </span><span class="s1">FROM</span><span class="s2"> vw_JoinData</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">ANSI_NULLS</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">QUOTED_IDENTIFIER</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p1"><span class="s1">CREATE</span><span class="s2"> </span><span class="s1">TABLE</span><span class="s2"> [dbo].[prod_Churn](</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Customer_ID] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Gender] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Age] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Married] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[State] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Number_of_Referrals] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Tenure_in_Months] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Value_Deal] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Phone_Service] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Multiple_Lines] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Internet_Service] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Internet_Type] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Online_Security] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Online_Backup] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Device_Protection_Plan] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Premium_Support] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Streaming_TV] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Streaming_Movies] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Streaming_Music] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Unlimited_Data] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Contract] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Paperless_Billing] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Payment_Method] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Monthly_Charge] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Charges] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Refunds] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Extra_Data_Charges] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Long_Distance_Charges] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Revenue] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Customer_Status] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Churn_Category] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Churn_Reason] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span></p>
<p class="p1"><span class="s2">) </span><span class="s1">ON</span><span class="s2"> [PRIMARY]</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">ANSI_NULLS</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">QUOTED_IDENTIFIER</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p1"><span class="s1">CREATE</span><span class="s2"> </span><span class="s1">TABLE</span><span class="s2"> [dbo].[stg_Churn](</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Customer_ID] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NOT NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Gender] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Age] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Married] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[State] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Number_of_Referrals] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Tenure_in_Months] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Value_Deal] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Phone_Service] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Multiple_Lines] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Internet_Service] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Internet_Type] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Online_Security] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Online_Backup] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Device_Protection_Plan] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Premium_Support] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Streaming_TV] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Streaming_Movies] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Streaming_Music] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Unlimited_Data] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Contract] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Paperless_Billing] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Payment_Method] [varchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Monthly_Charge] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Charges] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Refunds] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Extra_Data_Charges] [tinyint] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Long_Distance_Charges] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Total_Revenue] [float] </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Customer_Status] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Churn_Category] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Churn_Reason] [nvarchar](</span><span class="s5">50</span><span class="s2">) </span><span class="s1">NULL</span></p>
<p class="p1"><span class="s2">) </span><span class="s1">ON</span><span class="s2"> [PRIMARY]</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">ANSI_PADDING</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p2"><span class="s2">ALTER</span><span class="s6"> </span><span class="s2">TABLE</span><span class="s6"> [dbo].[stg_Churn] </span><span class="s2">ADD</span><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">CONSTRAINT</span><span class="s6"> [PK_stg_Churn] </span><span class="s2">PRIMARY KEY</span><span class="s6"> </span><span class="s2">CLUSTERED</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>[Customer_ID] </span><span class="s1">ASC</span></p>
<p class="p2"><span class="s6">)</span><span class="s2">WITH</span><span class="s6"> (</span><span class="s2">PAD_INDEX</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">OFF</span><span class="s6">, </span><span class="s2">STATISTICS_NORECOMPUTE</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">OFF</span><span class="s6">, </span><span class="s2">SORT_IN_TEMPDB</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">OFF</span><span class="s6">, </span><span class="s2">IGNORE_DUP_KEY</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">OFF</span><span class="s6">, </span><span class="s2">ONLINE</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">OFF</span><span class="s6">, </span><span class="s2">ALLOW_ROW_LOCKS</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">ON</span><span class="s6">, </span><span class="s2">ALLOW_PAGE_LOCKS</span><span class="s6"> </span><span class="s8">=</span><span class="s6"> </span><span class="s2">ON</span><span class="s6">) </span><span class="s2">ON</span><span class="s6"> [PRIMARY]</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">ANSI_NULLS</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">QUOTED_IDENTIFIER</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p1"><span class="s1">CREATE</span><span class="s2"> View [dbo].[vw_churnData] </span><span class="s1">as</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">SELECT</span><span class="s2"> </span><span class="s4">*</span><span class="s2"> </span><span class="s1">FROM</span><span class="s2"> dbo.prod_Churn </span><span class="s1">where</span><span class="s2"> Customer_Status </span><span class="s1">IN</span><span class="s2"> (</span><span class="s9">'Churned'</span><span class="s2">, </span><span class="s9">'Stayed'</span><span class="s2">)</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">ANSI_NULLS</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p2"><span class="s2">SET</span><span class="s6"> </span><span class="s2">QUOTED_IDENTIFIER</span><span class="s6"> </span><span class="s2">ON</span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p1"><span class="s1">CREATE</span><span class="s2"> View [dbo].[vw_JoinData] </span><span class="s1">as</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">SELECT</span><span class="s2"> </span><span class="s4">*</span><span class="s2"> </span><span class="s1">FROM</span><span class="s2"> prod_Churn </span><span class="s1">where</span><span class="s2"> Customer_Status </span><span class="s4">=</span><span class="s2"> </span><span class="s9">'Joined'</span><span class="s2"> <span class="Apple-converted-space">   </span></span></p>
<p class="p2"><span class="s2">GO</span></p>
<p class="p3"><span class="s7"></span><br></p>
</body>
</html>
